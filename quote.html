<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get a Quote | Cache Cow Snow Plows</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="assets/images/icon_snowflake.png">
</head>

<body>
    <canvas id="snow-canvas"></canvas>

    <header></header> <!-- Injected -->

    <div style="height: 80px;"></div> <!-- Spacer -->

    <section class="section">
        <div class="container">
            <div class="section-header">
                <h2>Request a Free Quote</h2>
                <p>Fill out the form below and we'll get back to you within 24 hours.</p>
            </div>

            <div class="container" style="max-width: 800px;">
                <form id="quote-form">
                    <div class="grid" style="grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label class="form-label">Full Name</label>
                            <input type="text" id="name" class="form-control" placeholder="John Snow" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Phone Number</label>
                            <input type="tel" id="phone" class="form-control" placeholder="(435) 555-0100" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Service Address</label>
                        <input type="text" id="address" class="form-control" placeholder="123 Winter Lane, Logan, UT"
                            required>
                    </div>

                    <div class="grid" style="grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label class="form-label">Service Type</label>
                            <select id="serviceType" class="form-control">
                                <option>Residential Plowing</option>
                                <option>Commercial Lot</option>
                                <option>One-Time Dig Out</option>
                                <option>Salting Only</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Approximate Size</label>
                            <select id="size" class="form-control">
                                <option>Standard Driveway (1-2 cars)</option>
                                <option>Large Driveway (3+ cars)</option>
                                <option>Circular Driveway</option>
                                <option>Commercial Lot (< 1 Acre)</option>
                                <option>Commercial Lot (> 1 Acre)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Additional Details / Gating Instructions</label>
                        <textarea id="details" class="form-control"
                            placeholder="Any obstacles we should know about?"></textarea>
                    </div>

                    <div style="text-align: center; margin-top: 2rem;">
                        <button type="submit" id="submit-btn" class="btn"
                            style="width: 100%; max-width: 300px; font-size: 1.1rem;">Submit Request</button>
                        <p id="form-status" style="margin-top: 1rem; font-weight: 600;"></p>
                    </div>
                </form>

                <script src="config.js"></script>
                <script>
                    const form = document.getElementById('quote-form');
                    const statusText = document.getElementById('form-status');
                    const submitBtn = document.getElementById('submit-btn');

                    // URL is now loaded from config.js
                    const GOOGLE_SCRIPT_URL = CONFIG.GOOGLE_SCRIPT_URL;

                    form.addEventListener('submit', e => {
                        e.preventDefault();

                        if (GOOGLE_SCRIPT_URL === 'INSERT_YOUR_WEB_APP_URL_HERE') {
                            alert('NOTE: You have not configured the Google Apps Script URL in config.js. Please deploy your script and update the config file.');
                            // Proceeding to "success" for demo
                            window.location.href = 'thank_you.html';
                            return;
                        }

                        submitBtn.disabled = true;
                        submitBtn.textContent = 'Sending...';
                        statusText.textContent = '';
                        statusText.style.color = 'var(--text-color)';

                        const data = {
                            name: document.getElementById('name').value,
                            phone: document.getElementById('phone').value,
                            address: document.getElementById('address').value,
                            serviceType: document.getElementById('serviceType').value,
                            size: document.getElementById('size').value,
                            details: document.getElementById('details').value
                        };

                        fetch(GOOGLE_SCRIPT_URL, {
                            method: 'POST',
                            mode: 'no-cors', // Important for Google Apps Script
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(data)
                        })
                            .then(response => {
                                // REDIRECT TO THANK YOU PAGE
                                window.location.href = 'thank_you.html';
                            })
                            .catch(error => {
                                console.error('Error!', error.message);
                                statusText.textContent = 'Error sending quote. Please call us instead.';
                                statusText.style.color = 'red';
                                submitBtn.disabled = false;
                                submitBtn.textContent = 'Try Again';
                            });
                    });
                </script>
            </div>
        </div>
    </section>

    <footer></footer> <!-- Injected -->

    <script src="components.js"></script>
    <script src="main.js"></script>
</body>

</html>